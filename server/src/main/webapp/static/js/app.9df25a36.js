(function(t){function e(e){for(var a,r,u=e[0],o=e[1],l=e[2],m=0,d=[];m<u.length;m++)r=u[m],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&d.push(i[r][0]),i[r]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a]);c&&c(e);while(d.length)d.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,u=1;u<n.length;u++){var o=n[u];0!==i[o]&&(a=!1)}a&&(s.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},i={app:0},s=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],o=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var c=o;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var a=n("85ec"),i=n.n(a);i.a},"0ebe":function(t,e,n){},"17e8":function(t,e,n){"use strict";var a=n("3bd5"),i=n.n(a);i.a},"3bd5":function(t,e,n){},"52b8":function(t,e,n){"use strict";var a=n("810a"),i=n.n(a);i.a},"56d7":function(t,e,n){"use strict";n.r(e);n("4de4"),n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("0cdd");var a=n("2b0e"),i=n("8c4f"),s=n("5f5b");n("ab8b"),n("2dd8");a["default"].use(s["a"]);var r,u,o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("b-navbar",{attrs:{id:"bar",toggleable:"lg",type:"dark",variant:"info"}},[n("b-navbar-brand",{attrs:{href:"#"}},[t._v("Cam Guard")])],1),n("div",{attrs:{id:"main"}},[n("router-view")],1)],1)},l=[],c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"board"}},[n("b-row",[n("TimeRange")],1),t._l(t.getWebcams,(function(e){return n("b-row",{key:e},[n("h1",[t._v(" "+t._s(e)+" ")]),n("Webcam",{attrs:{webcamName:e}})],1)}))],2)},m=[],d=(n("4160"),n("d81d"),n("159b"),n("ade3")),f=n("2f62"),g=n("1157"),h=n.n(g),p={post:function(t,e){return h.a.ajax({url:t,type:"POST",data:JSON.stringify(e),dataType:"json",contentType:"application/json; charset=utf-8"})},get:function(t,e){return null==e?h.a.get(t):h.a.get(t,e)},delete:function(t){return h.a.ajax({url:t,method:"DELETE"})}},b={listWebcams:function(){return p.get("/api/webcams/list")},listImages:function(t,e,n){return p.get("/api/images/list/"+t,{start:e,end:n})}};a["default"].use(f["a"]);var v="UPDATE_WEBCAMS",_="UPDATE_IMAGES_LIST",y="UPDATE_TIME_RANGE",x="ACTION_LOAD_WEBCAMS",w="ACTION_LOAD_IMAGES",O="ACTION_UPDATE_TIME_RANGE",I=new f["a"].Store({state:{webcams:[],imagesByWebcamName:{},timeRange:{start:new Date(Date.now()-6e5),end:new Date}},mutations:(r={},Object(d["a"])(r,v,(function(t,e){console.log(e),t.webcams=e})),Object(d["a"])(r,_,(function(t,e){console.log(_,e),t.imagesByWebcamName=Object.assign({},t.imagesByWebcamName,e)})),Object(d["a"])(r,y,(function(t,e){t.timeRange=e})),r),actions:(u={},Object(d["a"])(u,x,(function(t){console.log(x),b.listWebcams().done((function(e){t.commit(v,e),e.forEach((function(e){t.dispatch(w,e)}))}))})),Object(d["a"])(u,w,(function(t,e){console.log(w),b.listImages(e,t.state.timeRange.start.valueOf(),t.state.timeRange.end.valueOf()).done((function(n){console.log("loading images list",n);var a={};a[e]=n.map((function(t){return"/api/images/retrieve/"+t})),t.commit(_,a)}))})),Object(d["a"])(u,O,(function(t,e){t.commit(y,e),t.state.webcams.forEach((function(e){return t.dispatch(w,e)}))})),u)}),D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"webcam"}},[n("div",{staticClass:"rowSnapshot"},t._l(t.getImages,(function(e,a){return n("img",{key:e,staticClass:"images",attrs:{src:e,width:"200",title:e},on:{click:function(e){t.index=a}}})})),0),n("GalerySlideShowVue",{attrs:{images:t.getImages,index:t.index},on:{close:function(e){t.index=null}}})],1)},M=[],T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"modal"}},[null!==t.imgIndex?n("div",{staticClass:"vgs",on:{click:t.close}},[n("button",{staticClass:"vgs__close",attrs:{type:"button"},on:{click:t.close}},[t._v(" × ")]),t.isMultiple?n("button",{staticClass:"vgs__prev",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.onPrev(e)}}},[t._v(" ‹ ")]):t._e(),t.images?n("div",{staticClass:"vgs__container",on:{click:function(e){return e.stopPropagation(),t.onNext(e)}}},[n("img",{staticClass:"vgs__container__img",attrs:{src:t.imageUrl,alt:t.alt},on:{click:function(e){return e.stopPropagation(),t.onNext(e)}}}),t._t("default")],2):t._e(),t.isMultiple?n("button",{staticClass:"vgs__next",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.onNext(e)}}},[t._v(" › ")]):t._e(),t.isMultiple?n("div",{ref:"gallery",staticClass:"vgs__gallery"},[t.images?n("div",{staticClass:"vgs__gallery__title"},[t._v(" "+t._s(t.imgIndex+1)+" / "+t._s(t.images.length)+" ")]):t._e(),t.images?n("div",{staticClass:"vgs__gallery__container",style:{transform:"translate("+t.galleryXPos+"px, 0)"}},t._l(t.images,(function(e,a){return n("img",{key:a,staticClass:"vgs__gallery__container__img",class:{"vgs__gallery__container__img--active":a===t.imgIndex},attrs:{src:"string"===typeof e?e:e.url,alt:"string"===typeof e?"":e.alt},on:{click:function(n){return n.stopPropagation(),t.onClickThumb(e,a)}}})})),0):t._e()]):t._e()]):t._e()])},k=[],j=(n("a9e3"),n("53ca")),S={props:{images:{type:Array,required:!0},index:{type:Number,required:!1,default:null}},data:function(){return{imgIndex:this.index,image:null,galleryXPos:0,thumbnailWidth:120}},computed:{imageUrl:function(){var t=this.images[this.imgIndex];return"string"===typeof t?t:t.url},alt:function(){var t=this.images[this.imgIndex];return"object"===Object(j["a"])(t)?t.alt:""},isMultiple:function(){return this.images.length>1}},watch:{index:function(t,e){var n=this;this.imgIndex=t,null==e&&null!=t&&this.$nextTick((function(){n.updateThumbails()}))}},mounted:function(){var t=this;window.addEventListener("keydown",(function(e){37===e.keyCode?t.onPrev():39===e.keyCode?t.onNext():27===e.keyCode&&t.close()}))},methods:{close:function(){this.imgIndex=null,this.$emit("close")},onPrev:function(){null!==this.imgIndex&&(this.imgIndex>0?this.imgIndex--:this.imgIndex=this.images.length-1,this.updateThumbails())},onNext:function(){null!==this.imgIndex&&(this.imgIndex<this.images.length-1?this.imgIndex++:this.imgIndex=0,this.updateThumbails())},onClickThumb:function(t,e){this.imgIndex=e,this.updateThumbails()},updateThumbails:function(){if(this.$refs.gallery){var t=this.$refs.gallery.clientWidth,e=this.imgIndex*this.thumbnailWidth,n=this.images.length*this.thumbnailWidth,a=Math.floor(t/(2*this.thumbnailWidth))*this.thumbnailWidth;n<t||(e<a?this.galleryXPos=0:e>this.images.length*this.thumbnailWidth-t+a?this.galleryXPos=-(this.images.length*this.thumbnailWidth-t-20):this.galleryXPos=-this.imgIndex*this.thumbnailWidth+a)}}}},$=S,E=(n("7837"),n("2877")),C=Object(E["a"])($,T,k,!1,null,null,null),W=C.exports,N={name:"Webcam",props:["webcamName"],data:function(){return{index:null}},computed:{getImagesByWebcamName:function(){return console.log(this.webcamName,this.$store.state.imagesByWebcamName),this.$store.state.imagesByWebcamName},getImages:function(){return console.log(this.webcamName,this.$store.state.imagesByWebcamName),this.$store.state.imagesByWebcamName[this.webcamName]}},components:{GalerySlideShowVue:W}},P=N,R=(n("52b8"),Object(E["a"])(P,D,M,!1,null,"47a2eea3",null)),A=R.exports,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-form",{attrs:{inline:""}},[n("b-input",{ref:"startDate",attrs:{type:"text",value:t.getStartDate,placeholder:"Date de début(aaaa-mm-dd)"}}),t._v(" "),n("b-input",{ref:"startHours",staticClass:"hourMinuteInput",attrs:{type:"number",value:t.getStartHour,"no-wheel":"true",min:"0",max:"23"}}),t._v(" : "),n("b-input",{ref:"startMinutes",staticClass:"hourMinuteInput",attrs:{type:"number",value:t.getStartMinute,"no-wheel":"true",min:"0",max:"60"}}),t._v(" -> "),n("b-input",{ref:"endDate",attrs:{type:"text",value:t.getEndDate,placeholder:"Date de fin(aaaa-mm-dd)"}}),t._v(" "),n("b-input",{ref:"endHours",staticClass:"hourMinuteInput",attrs:{type:"number",value:t.getEndHour,"no-wheel":"true",min:"0",max:"23"}}),t._v(" : "),n("b-input",{ref:"endMinutes",staticClass:"hourMinuteInput",attrs:{type:"number",value:t.getEndMinute,"no-wheel":"true",min:"0",max:"60"}}),n("b-button",{attrs:{variant:"success"},on:{click:t.updateRange}},[t._v("Ok")])],1)},B=[],V=(n("fb6a"),n("d4ec")),G=n("bee2"),U=function(){function t(){Object(V["a"])(this,t)}return Object(G["a"])(t,[{key:"convertInputValue",value:function(t){return new Date(t+"T00:00")}},{key:"addDay",value:function(t,e){var n=new Date(t.valueOf());return n.setDate(n.getDate()+e),n}},{key:"sameDay",value:function(t,e){return null!=t&&null!=e&&(t.getDate()==e.getDate()&&t.getMonth()==e.getMonth()&&t.getYear()==e.getYear())}},{key:"removeTime",value:function(t){var e=new Date(t.valueOf());return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}},{key:"build7DayBefore",value:function(t){var e=this.removeTime(t),n=[],a=this.addDay(e,-6);a=this.removeTime(a);while(a.valueOf()<=e.valueOf())n.push(a),a=this.addDay(a,1);return n}},{key:"filterByDay",value:function(t,e,n){var a=this;return null==e?[]:e.filter((function(e){return a.sameDay(t,n(e))}))}},{key:"formatDateISO",value:function(t){return t.toISOString().slice(0,10)}}]),t}(),L=new U,X=L,J={name:"TimeRange",computed:{getStartDate:function(){return X.formatDateISO(this.$store.state.timeRange.start)},getStartHour:function(){return this.$store.state.timeRange.start.getHours()},getStartMinute:function(){return this.$store.state.timeRange.start.getMinutes()},getEndDate:function(){return X.formatDateISO(this.$store.state.timeRange.end)},getEndHour:function(){return this.$store.state.timeRange.end.getHours()},getEndMinute:function(){return this.$store.state.timeRange.end.getMinutes()}},methods:{updateRange:function(){var t=X.convertInputValue(this.$refs.startDate.localValue);t.setHours(this.$refs.startHours.localValue),t.setMinutes(this.$refs.startMinutes.localValue);var e=X.convertInputValue(this.$refs.endDate.localValue);e.setHours(this.$refs.endHours.localValue),e.setMinutes(this.$refs.endMinutes.localValue),this.$store.dispatch(O,{start:t,end:e})}}},Y=J,q=(n("17e8"),Object(E["a"])(Y,H,B,!1,null,"19520c98",null)),z=q.exports,F={name:"Main",created:function(){this.$store.dispatch(x)},computed:{getWebcams:function(){return this.$store.state.webcams}},components:{Webcam:A,TimeRange:z}},K=F,Q=(n("8835"),Object(E["a"])(K,c,m,!1,null,"6a356511",null)),Z=Q.exports,tt=[{path:"/",component:Z}],et=new i["a"]({routes:tt}),nt={name:"app",created:function(){},computed:Object(f["b"])(["stateConnected"]),router:et},at=nt,it=(n("034f"),Object(E["a"])(at,o,l,!1,null,null,null)),st=it.exports;a["default"].use(i["a"]),a["default"].config.productionTip=!1,a["default"].prototype.$store=I,a["default"].filter("formatDate",(function(t){if(t)return t.getDate()+"/"+t.getMonth()+"/"+t.getYear()})),new a["default"]({render:function(t){return t(st)}}).$mount("#app")},7837:function(t,e,n){"use strict";var a=n("e1dd"),i=n.n(a);i.a},"810a":function(t,e,n){},"85ec":function(t,e,n){},8835:function(t,e,n){"use strict";var a=n("0ebe"),i=n.n(a);i.a},e1dd:function(t,e,n){}});
//# sourceMappingURL=app.9df25a36.js.map